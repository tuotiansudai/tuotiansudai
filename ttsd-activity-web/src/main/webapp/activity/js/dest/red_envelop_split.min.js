require(["jquery","layerWrapper","commonFun","validator"],function(a,b,c,d){!function(){if("pc"==globalFun.browserRedirect()){var b=a(document).width(),c=.55*b;a(".register-section-box").css("padding-top",c)}}(),a(function(){var e=a("#redEnvelopReferrer"),f=a("#redEnvelopSplit");!function(){f.length&&(a(".envelop-box",f).eq(1).hide(),a(".envelop-button span",f).on("click",function(){var b=a(this),c=b.index();b.addClass("active").siblings("span").removeClass("active"),a(".envelop-box",f).eq(c).show().siblings(".envelop-box").hide()}),a(".to-invite-friend",f).on("click",function(){var c=a(this),d=c.data("url"),e=location.href;"share"==globalFun.parseURL(e).params.source?b.msg("本活动仅限使用拓天速贷app参加，<br/>请下载app后再进行邀请。",{offset:["","10%"]}):location.href=d}))}(),function(){var a=globalFun.$("#phoneForm");if(a){var c=new d,e=location.href,f=globalFun.parseURL(e),g=f.params.channel,h=f.params.loginName;a.loginName.value=h,a.channel.value=g,c.add(a.mobile,[{strategy:"isNonEmpty",errorMsg:"手机号不能为空"},{strategy:"isMobile",errorMsg:"手机号格式不正确"},{strategy:"isMobileExist",errorMsg:"手机号已存在"}]),a.onsubmit=function(d){d.preventDefault();var e=c.start(a.mobile);if(e)return void b.msg(e);a.submit()}}}(),function(){var f=globalFun.$("#registerForm"),g=a(f).find(".btn-captcha");if(a(f).length){a(".agreement",a(f)).on("click",function(){b.open({type:1,title:"拓天速贷服务协议",shadeClose:!0,move:!1,scrollbar:!0,skin:"register-skin",content:a("#agreementBox")})});var h=new d;h.add(f.captcha,[{strategy:"isNonEmpty",errorMsg:"验证码不能为空"},{strategy:"isNumber:6",errorMsg:"验证码为6位数字"}]),h.add(f.password,[{strategy:"isNonEmpty",errorMsg:"密码不能为空"},{strategy:"checkPassword",errorMsg:"密码为6位至20位，不能全是数字"}]),g.on("click",function(d){var e=a(this),h=f.mobile.value;d.preventDefault(),e.prop("disabled",!0);var i={url:"/register/user/"+h+"/send-register-captcha",type:"get",dataType:"json"};c.useAjax(i,function(a){g.prop("disabled",!1);var d=a.data;d.status&&!d.isRestricted?c.countDownLoan({btnDom:g}):!d.status&&d.isRestricted?b.msg("短信发送频繁，请稍后再试"):d.status||d.isRestricted||b.msg("图形验证码不正确")})}),f.onsubmit=function(d){d.preventDefault();for(var g,i=a(f).find("input:visible"),j=0,k=i.length;j<k;j++)if(g=h.start(i[j])){b.msg(g);break}g||c.useAjax({url:"/activity/red-envelop-split/user-register",type:"POST",data:a(f).serialize()},function(c){if(c){var d=a(".step-two",e),f=a(".step-three",e);d.hide(),f.show(),a(".message-tip",e).hide()}else b.msg("验证码不正确")})}}}(),function(){var a=globalFun.$("#downloadApp");a&&globalFun.addEventHandler(a,"click",globalFun.toExperience.bind(globalFun))}()})});