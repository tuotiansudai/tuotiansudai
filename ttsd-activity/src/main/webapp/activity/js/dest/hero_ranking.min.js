require(["jquery","underscore","layerWrapper","template","jquery.ajax.extension"],function(a,b,c,d){a(function(){function d(a,b){var c=new Date(a);c.setDate(c.getDate()+b);var d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate();return d+"-"+(e<10?"0"+e:e)+"-"+(f<10?"0"+f:f)}function e(d){a.ajax({url:"/activity/hero-ranking/invest/"+d,type:"GET",dataType:"json"}).done(function(c){if(c.status){var d=a(".nodata-invest"),e=a("#investRanking-tbody").parents("table");if(b.isNull(c.records)||0==c.records.length)return d.show(),void e.hide();e.show(),d.hide(),c.type="invest",a("#investRanking-tbody").html(r(c))}}).fail(function(){c.msg("请求失败，请重试！")})}function f(d){a.ajax({url:"/activity/hero-ranking/referrer-invest/"+d,type:"GET",dataType:"json"}).done(function(c){if(c.status){var d=a(".nodata-refer"),e=a("#referRanking-tbody").parents("table");if(b.isNull(c.records)||0==c.records.length)return d.show(),void e.hide();e.show(),d.hide(),c.type="referrer",a("#referRanking-tbody").html(r(c))}}).fail(function(){c.msg("请求失败，请重试！")})}var g=a("#getVip"),h=a(".get-rank"),i=a("#TodayAwards"),j=a("#investRanking-button"),k=a("#referRanking-button"),l=a("#heroNext"),m=a("#referPre"),n=a("#referNext"),o=a("#heroPre"),p=a.trim(i.text()),q=a("#tplTable").html(),r=b.template(q);p.replace(/-/gi,"")>=20160731&&(l.hide(),n.hide()),j.find(".button-small").on("click",function(b){var c,f=a("#HistoryAwards"),g=f.find("em").show().text();/heroPre/.test(b.target.id)?c=d(g,-1):/heroNext/.test(b.target.id)&&(c=d(g,1)),c.replace(/-/gi,"")>=20160731?l.hide():l.show(),c.replace(/-/gi,"")<=20160701?o.hide():o.show(),f.find("em").text(c),e(c)}),k.find(".button-small").on("click",function(b){var c,e=a("#ReferRankingDate"),g=e.find("em").text();/referPre/.test(b.target.id)?c=d(g,-1):/referNext/.test(b.target.id)&&(c=d(g,1)),c.replace(/-/gi,"")>=20160731?n.hide():n.show(),c.replace(/-/gi,"")<=20160701?m.hide():m.show(),e.find("em").text(c),f(c)}),g.on("click",function(d){d.preventDefault(),a.ajax({url:"/membership/receive",type:"GET",dataType:"json"}).done(function(d){var e=a("#vipTipModelTpl").html(),f=b.template(e);a("#vipTipModel").html(f(d)),c.open({type:1,move:!1,area:["320px","auto"],title:"领取须知",content:a("#vipTipModel")})}).fail(function(){c.msg("请求失败，请重试！")})}),a("body").on("click","#closeTip",function(a){a.preventDefault(),c.closeAll()}),e("2016-07-31"),f("2016-07-31"),h.on("click",function(){cnzzPush.trackClick("153周年庆","我要上榜","英雄榜")}),g.on("click",function(){cnzzPush.trackClick("152周年庆","领取会员","英雄榜")})})});