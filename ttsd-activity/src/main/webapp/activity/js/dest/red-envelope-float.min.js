define(["jquery","layerWrapper","jquery.validate","jquery.validate.extension","drag"],function(a,b){var c=a(".count-form .close-count"),d=a(".count-form"),e=a(".cal-btn");a(window).scrollTop()>a(window).height()/2?a(".back-top").fadeIn("fast"):a(".back-top").fadeOut("fast"),a(window).scroll(function(){a(window).scrollTop()>a(window).height()/2?a(".back-top").fadeIn("fast"):a(".back-top").fadeOut("fast")}),a(".back-top .nav-text").on("click",function(b){b.preventDefault(),a("body,html").animate({scrollTop:0},"fast")}),a("#countForm").validate({debug:!0,rules:{money:{required:!0,number:!0},month:{required:!0,number:!0},bite:{required:!0,number:!0}},messages:{money:{required:"请输入投资金额！",number:"请输入有效的数字！"},month:{required:"请输入投资时长！",number:"请输入有效的数字！"},bite:{required:"请输入年化利率！",number:"请输入有效的数字！"}},submitHandler:function(b){var c=Math.round(a("#moneyNum").val()),d=Math.round(a("#monthNum").val()),e=Math.round(a("#biteNum").val())/100,f=a("#resultNum"),g=c+c*d*e*30*.9/365;f.text(g.toFixed(2))},errorPlacement:function(a,b){a.insertAfter(b.parent())}}),c.on("click",function(b){b.preventDefault();var c=a(".fix-nav-list li");d.hide(),c.removeClass("active")}),e.on("click",function(b){b.preventDefault(),a(this).addClass("active"),d.show()}),a("#resetBtn").on("click",function(b){b.preventDefault(),d.find(".int-text").val(""),a("#resultNum").text("0")}),d.dragging({move:"both",randomPosition:!1,hander:".hander"}),a(".type-list dt").on("click",function(b){b.preventDefault();var c=a(this),d=c.siblings("dd");d.slideToggle("fast")}),a(".type-list dd").on("click",function(b){b.preventDefault();var c=a(this),d=c.parent(".type-list"),e=d.find("dt"),f=d.find("dd");e.text(c.text()).attr("data-type",c.attr("data-type")),f.hide()}),a(".feed-close").on("click",function(b){b.preventDefault();var c=a(this),d=a(".fix-nav-list .show-feed"),e=c.closest(".feedback-model");e.hide(),d.removeClass("active")}),a(".fix-nav-list .show-feed").on("click",function(b){b.preventDefault();var c=a(this),d=a(".feedback-container");c.addClass("active"),d.show()}),a("#captcha").on("click",function(b){b.preventDefault(),a(this).attr("src","/feedback/captcha?"+(new Date).getTime().toString())}),a("#captchaText").on("focusin",function(b){b.preventDefault(),a("#captchaError").hide()}),a("#feedForm").validate({debug:!0,ignore:".ignore",rules:{content:{required:!0,minlength:14,maxlength:200},captcha:{required:!0,maxlength:5}},messages:{content:{required:"内容不能为空！",minlength:"文字限制最小为14",maxlength:"文字限制最大为200"},captcha:{required:"验证码不能为空！",maxlength:"请输入5位验证码！"}},submitHandler:function(c){a.ajax({url:"/feedback/submit",type:"POST",dataType:"json",data:{contact:a("#phoneText").val(),type:a(".type-list").find("dt").attr("data-type"),content:a("#textArea").val(),captcha:a("#captchaText").val()}}).done(function(b){1==b.success?(a("#feedbackConatiner").hide(),a("#feedForm").find(".int-text").val(""),a("#captcha").trigger("click"),a("#feedbackModel").show()):(a("#captchaError").text("验证码错误！").show(),a("#captcha").trigger("click"))}).fail(function(){b.msg("请求失败，请重试！")})},errorPlacement:function(a,b){b.parent().append(a)}})});