require(["jquery","layerWrapper","template","drawCircle","jquery.ajax.extension"],function(a,b,c,d){a(function(){var d=a("#signBtn"),e=a("#signLayer"),f=a("#closeSign"),g=a(".material-list li"),h=a(".point-rule-tip");d.on("click",function(d){d.preventDefault();var f=a(this),g=a(".sign-text"),h=a(".tomorrow-text"),i=a(".sign-point"),j=a(".intro-text"),k=a(".next-text"),l=a("#signBtn");a.ajax({url:f.attr("data-url"),type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(d){d.data.status?(1==d.data.signIn?g.html("您今天已签到"):g.html("签到成功"),h.html("明日签到可获得"+d.data.nextSignInPoint+"积分"),j.html(d.data.currentRewardDesc),k.html(d.data.nextRewardDesc),l.addClass("no-click").html("已签到"),i.find("span").html(d.data.signInPoint),e.fadeIn("fast")):(a("#errorTip").html(c("errorTipTpl",d.data)),b.open({type:1,title:!1,area:["300px","180px"],content:a("#errorTip")}))})}),f.on("click",function(a){a.preventDefault(),location.href="/point-shop"}),g.on("click",function(b){b.preventDefault(),location.href=a(this).attr("data-href")}).on("click",".get-btn",function(b){b.preventDefault(),!!a(this).hasClass("active")&&(location.href=a(this).parent("a").attr("href")),b.stopPropagation()}),h.on("click",function(c){c.preventDefault(),b.open({type:1,title:!1,closeBtn:0,area:["auto","520px"],scrollbar:!0,content:a("#ruleInfoTip")})}),a("#ruleInfoTip").on("click",".close-btn",function(a){a.preventDefault(),b.closeAll()})}),function(b){var c=a("#pointContainer"),d={},e=a(".nine-lottery-group",c),f="/activity/point-draw/all-list",g="/activity/point-draw/user-list",h="/activity/point-draw/draw",i=a(".lottery-btn",e);c.find(".tip-list-frame .tip-list").each(function(b,c){var e=a(c).data("return");d[e]=c});var j={activityCategory:"POINT_SHOP_DRAW_1000"},b=new b(f,g,h,j,e);b.GiftRecord(),b.MyGift(),i.on("click",function(){b.beginLuckDraw(function(c){var e;if(0==c.returnCode){switch(c.prize){case"POINT_SHOP_INTEREST_COUPON_2":e=7;break;case"POINT_SHOP_RED_ENVELOPE_10":e=0;break;case"POINT_SHOP_POINT_500":e=1;break;case"POINT_SHOP_PHONE_CHARGE_10":e=5;break;case"OINT_SHOP_JD_100":e=2;break;case"POINT_SHOP_POINT_3000":e=6;break;case"POINT_SHOP_INTEREST_COUPON_5":e=3;break;case"RED_ENVELOPE_50_POINT_DRAW_REF_CARNIVAL":e=4}var f=c.prizeType.toLowerCase();a(d[f]).find(".prizeValue").text(c.prizeValue),b.lotteryRoll({elementId:"lotteryBox",speed:100,prize:e},d[f])}else 1==c.returnCode?b.tipWindowPop(d.nochance):2==c.returnCode?location.href="/login":3==c.returnCode?b.tipWindowPop(d.expired):4==c.returnCode&&b.tipWindowPop(d.authentication)})});var k=e.find(".lottery-right-group").find("h3 span");k.on("click",function(){var b=a(this),c=b.index(),d=e.find(".record-item");b.addClass("active").siblings().removeClass("active"),d.eq(c).show().siblings().hide()})}(d)});