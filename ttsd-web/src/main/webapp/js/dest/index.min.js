require(["jquery","underscore","layerWrapper","superslide","jquery.ajax.extension","commonFun","coupon-alert","red-envelope-float","count_down","jquery.validate","autoNumeric"],function(a,b,c){function d(a){var b=a.find("ul:first"),c=b.find("li:first").height();b.animate({"margin-top":-c+"px"},600,function(){b.css({"margin-top":"0px"}).find("li:first").appendTo(b)})}function e(){var b=a(this).data("name");switch(b){case"/activity/landing-page":cnzzPush.trackClick("83首页","Banner模块","landingpage");break;case"/activity/rank-list":cnzzPush.trackClick("27首页","Banner模块","排行榜");break;case"/activity/birth-month":cnzzPush.trackClick("23首页","Banner模块","生日月");break;case"/activity/share-reward":cnzzPush.trackClick("74首页","Banner模块","推荐奖励");break;case"http://www.iqiyi.com/w_19rt7ygfmh.html#vfrm=8-8-0-1":cnzzPush.trackClick("25首页","Banner模块","上市");break;case"/activity/recruit":cnzzPush.trackClick("26首页","Banner模块","代理");break;case"/activity/app-download":cnzzPush.trackClick("83首页","Banner模块","app")}}function f(a,b){return 180*Math.atan2(b,a)/Math.PI}function g(a,b,c,d){var e=b-d,g=c-a,h=0;if(Math.abs(g)<2&&Math.abs(e)<2)return h;var i=f(g,e);return i>=-45&&45>i?h=4:i>=45&&135>i?h=1:i>=-135&&-45>i?h=2:(i>=135&&180>=i||i>=-180&&-135>i)&&(h=3),h}var h,i,j,k=a(".banner-box"),l=a(".banner-img-list",k),m=(a(".register-ad-box",k),a(".scroll-num",k)),n=a("#productFrame"),o=a(".dl-amount",n),p=a("li",m),q=l.find("li"),r=null,s=0,t=a(".book-invest-form"),u=a(".project-transfer-frame");o.find("i").filter(function(b){var c=a(this).text(),d=c.replace(/[^\d|.]*/g,"");return d.length>5}).css({"font-size":"16px"}),h=a(window).width(),i=q.first().find("img").width(),j=(i-h)/2,l.find("img").css({"margin-left":"-"+j+"px"}),a(".product-box .pad-m").click(function(){window.location.href=a(this).data("url")});var v=commonFun.browserRedirect();"pc"==v?(l.find("img.iphone-img").remove(),a("#bannerBox").slide({mainCell:".bd ul",effect:"leftLoop",autoPlay:!0})):"mobile"==v&&(l.find("img.pc-img").remove(),m.css({left:(h-25*m.find("li").length)/2,visibility:"visible"}),p.click(function(){var b=p.index(this);a(this).addClass("on").siblings().removeClass("on"),q.eq(b).fadeIn(500).siblings().fadeOut(500)}),k.hover(function(){clearInterval(r)},function(){r=setInterval(function(){var a=++s%q.length;p.eq(a).trigger("click")},6e3)}).trigger("mouseleave"),function(){var a,b;k.on("touchstart",function(c){a=c.originalEvent.changedTouches[0].pageX,b=c.originalEvent.changedTouches[0].pageY}),k.on("touchmove",function(a){a.preventDefault()}),k.on("touchend",function(c){var d,e;d=c.originalEvent.changedTouches[0].pageX,e=c.originalEvent.changedTouches[0].pageY;var f=g(a,b,d,e);switch(f){case 3:var h=++s%q.length;p.eq(h).trigger("click");break;case 4:var h=--s%q.length;p.eq(h).trigger("click")}})}());var w;a(".scroll-top").hover(function(){clearInterval(w)},function(){w=setInterval(function(){d(a(".scroll-top"))},2e3)}).trigger("mouseout"),a(".web-book-box,.book-text-tip").on("click",function(b){return b.preventDefault(),a(this).find("a.btn-normal").hasClass("not-anonymous")?void(location.href="/login"):a(this).find("a").hasClass("is-user")?(t.find(".init-radio-style").removeClass("on"),t.find('input[name="bookingAmount"]').val(""),void c.open({title:"预约投资",type:1,skin:"book-box-layer",area:["680px"],content:a(".book-invest-box")})):void(location.href="/register/account")}),a(".loan-btn").on("click","li",function(b){b.preventDefault(),window.location.href=a(this).data("url")}),a(".new-user-free").on("click",function(b){b.preventDefault(),window.location.href=a(this).attr("data-url")}),a(".project-transfer-mobile").on("click",".product-box-tran",function(){window.location.href=a(this).data("url")}),a(".mask-btn").on("click",function(b){b.preventDefault(),a(".new-user-free").removeClass("active")}),a(".guide-btn").on("click",function(b){b.preventDefault(),a(".product-box-inner").removeClass("active")}),a("input.autoNumeric").autoNumeric("init"),t.validate({focusInvalid:!1,errorPlacement:function(a,b){c.tips(a.text(),b,{tips:[1,"#efbf5c"],time:3e3,tipsMore:!0,area:"auto",maxWidth:"500"})},rules:{productType:{required:!0},bookingAmount:{required:!0,number:!0}},messages:{productType:{required:"请选择您希望投资的项目"},bookingAmount:{required:"请输入预计投资金额",number:"请输入正确的投资金额"}},submitHandler:function(b){var d=a(b).find('input[name="bookingAmount"]').val().replace(/,/gi,"");a(b).find('input[name="bookingAmount"]').val(d);var e=a(b).serialize();return a.ajax({url:"/booking-loan/invest?"+e,type:"GET",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(a){a.data.status&&(c.closeAll(),c.open({type:1,title:"&nbsp",area:["400px","185px"],content:'<div class="success-info-tip"> <i class="icon-tip"></i> <div class="detail-word"><h2>恭喜您预约成功！</h2> 当有可投项目时，客服人员会在第一时间与您联系，请您耐心等候并保持电话畅通。</div> </div>'}))}).fail(function(a){c.alert("接口错误")}),!1}}),t.find(".init-radio-style").on("click",function(){var b=a(this);t.find(".init-radio-style").removeClass("on"),t.find("input:radio").prop("checked",!1),b.addClass("on"),b.find("input:radio").prop("checked",!0)}),a.ajax({url:"/transfer-list/homePage",data:{index:1,pageSize:2},type:"GET",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(c){var d=a("#transerTpl").html(),e=a("#transerTplMobile").html(),f=b.template(d),g=b.template(e),h={};h.list=c;var i=f(h),j=g(h),k=u.find(".loan-box-inner"),l=a(".project-transfer-mobile");k.html(i),l.html(j)}),a(".banner-img-list a").on("click",e)});