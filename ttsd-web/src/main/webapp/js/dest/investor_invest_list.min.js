require(["jquery","mustache","text!/tpl/investor-invest-table.mustache","text!/tpl/investor-invest-repay-table.mustache","moment","pagination","layerWrapper","daterangepicker","jquery.ajax.extension"],function(a,b,c,d,e,f,g){var h=e().format("YYYY-MM-DD"),i=e().subtract(1,"week").format("YYYY-MM-DD"),j=e().subtract(1,"month").format("YYYY-MM-DD"),k=e().subtract(6,"month").format("YYYY-MM-DD"),l=a(".date-filter"),m=a(".status-filter"),n=a("#date-picker"),o=a(".pagination");n.dateRangePicker({separator:" ~ "});var p=function(){var b=a(".date-filter .select-item.current").data("day");switch(b){case 1:n.val(h+"~"+h);break;case 7:n.val(i+"~"+h);break;case 30:n.val(j+"~"+h);break;case 180:n.val(k+"~"+h);break;default:n.val("")}},q=function(e){var f=n.val().split("~"),h=a.trim(f[0])||"",i=a.trim(f[1])||"",j=a(".status-filter .select-item.current").data("status"),k={startTime:h,endTime:i,status:j,index:e||1};o.loadPagination(k,function(e){var f=b.render(c,e);a(".invest-list").html(f),a(".invest-list .show-invest-repay").click(function(){a.ajax({url:a(this).data("url"),type:"get",dataType:"json",contentType:"application/json; charset=UTF-8"}).success(function(c){var e=c.data;if(e.isLoanCompleted="COMPLETE"==j,e.csrfToken=a("meta[name='_csrf']").attr("content"),e.status){_.each(e.records,function(a){switch(e.loanId=a.loanId,a.loanRepayStatus){case"REPAYING":a.status="待还";break;case"COMPLETE":a.status="完成";break;case"CANCEL":a.status="流标"}});var f=b.render(d,e);g.open({type:1,title:!1,offset:"80px",area:["1000px"],shadeClose:!0,content:f})}})})}),a(".invest-list").on("mouseenter",".project-name",function(){g.closeAll("tips"),a.trim(a(this).text()).length>15&&g.tips(a(this).text(),a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}),a(".invest-list").on("mouseenter",".birth-icon",function(){g.closeAll("tips");var b=parseFloat(a(this).attr("data-benefit")),c=b+1;g.tips("您已享受生日福利，首月收益翻"+c+"倍",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})})};p(),q(),l.find(".select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),p(),q()}),m.find(".select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),q()}),a(".apply-btn").click(function(){q(),a(".date-filter .select-item").removeClass("current")})});