require(["underscore","jquery","jquery.validate","csrf"],function(a,b){var c=b(".register-step-two .register-account-form"),d=function(a,c,d){var e=!1,f=d.validator,g=d.element,h=f.previousValue(g),i=d.errorMessage;b.ajax({url:a,type:"GET",dataType:"json",error:function(a){h.valid=e,f.stopRequest(g,e)},success:function(a){if(e=c(a)){var d=f.formSubmitted;f.prepareElement(g),f.formSubmitted=d,f.successList.push(g),delete f.invalid[g.name],f.showErrors()}else{var j={};j[g.name]=h.message=b.isFunction(i)?i(value):i,f.invalid[g.name]=!0,f.showErrors(j)}h.valid=e,f.stopRequest(g,e)}})},e=function(a,c,e){var f=this.previousValue(c),g=this;if(f.old===a)return f.valid;f.old=a,this.startRequest(c);var h=g.defaultMessage(c,"isExist"),i=function(a){return a.success&&!a.data.status},j=b.validator.format(e);return d(j(a),i,{validator:g,element:c,errorMessage:h}),"pending"};b.validator.addMethod("regex",function(a,b,c){var d=new RegExp(c);return this.optional(b)||d.test(a)},"请检查您的输入"),b.validator.addMethod("isExist",function(a,b,c){return e.call(this,a,b,c)},b.validator.format("该记录已存在")),c.validate({success:"valid",focusCleanup:!0,focusInvalid:!1,onkeyup:!1,onfocusout:function(a){this.element(a)},rules:{userName:{required:!0},identityNumber:{required:!0,regex:"^[1-9]\\d{13,16}[a-zA-Z0-9]{1}$",isExist:"/register/account/identity-number/{0}/is-exist"}},messages:{userName:{required:"请输入姓名"},identityNumber:{required:"请输入身份证",regex:"身份证格式不正确",isExist:"身份证已存在"}}})});