require(["underscore","jquery","jquery.validate","jquery.validate.extension","jquery.form","jquery.ajax.extension","commonFun"],function(a,b){function c(){var a="";try{a=window.top.document.referrer}catch(b){if(window.parent)try{a=window.parent.document.referrer}catch(c){a=""}}return""===a&&(a=document.referrer),a}function d(){var a=c();for(var b in h)if(a.indexOf(h[b]["function"])!=-1){cnzzPush.trackClick(h[b].category,h[b].action,h[b].label);break}}var e=b(".register-account-form"),f=b(".button-layer",e),g=b('input[type="submit"]',e);e.validate({focusCleanup:!0,focusInvalid:!1,onfocusout:function(a){this.element(a),2==b("input.valid",e).length&&g.prop("disabled",!1),f.find(".status").removeClass("error").html("")},submitHandler:function(a){return d(),b(a).ajaxSubmit({dataType:"json",beforeSubmit:function(a,b,c){f.find(".status").removeClass("error").html("认证中..."),g.prop("disabled",!0)},success:function(a){if(a.data.status){f.find(".status").removeClass("error").html("认证成功");var b=document.referrer;setTimeout(location.href=b,3e3)}else f.find(".status").addClass("error").html("认证失败，请检查"),g.prop("disabled",!1)},error:function(a){f.find(".status").addClass("error").html("认证失败，请检查"),g.prop("disabled",!1)},complete:function(){}}),!1},onkeyup:function(a,c){var d=[16,17,18,20,35,36,37,38,39,40,45,144,225];9===c.which&&""===this.elementValue(a)||b.inArray(c.keyCode,d)!==-1||this.element(a)},rules:{userName:{required:!0},identityNumber:{required:!0,identityCheckValid:!0,identityCardAge:!0,isExist:"/register/account/identity-number/{0}/is-exist"}},messages:{userName:{required:"请输入姓名"},identityNumber:{required:"请输入身份证号",identityCheckValid:"您的身份证号码不正确",identityCardAge:"年龄未满18周岁",isExist:"身份证已存在"}}});var h=[{"function":"/recharge",category:"75实名认证页",action:"认证",label:"充值"},{"function":"/bind-card",category:"77实名认证页",action:"认证",label:"绑卡"},{"function":"/loan",category:"78实名认证页",action:"认证",label:"马上投资"},{"function":"/account",category:"79实名认证页",action:"认证",label:"签到"},{"function":"/point",category:"79实名认证页",action:"认证",label:"签到"},{"function":"/auto-invest/agreement",category:"80实名认证页",action:"认证",label:"授权自动投标"},{"function":"/personal-info",category:"82实名认证页",action:"认证",label:"开启免密"},{"function":"/register/user",category:"84实名认证页",action:"认证",label:"注册后"}]});