require(["jquery","pagination","mustache","text!/tpl/loan-invest-list.mustache","layerWrapper","csrf","autoNumeric"],function(a,b,c,d,e){function f(b){window.setInterval(function(){var c=0,d=0,e=0,f=0;1800>=b&&(b>0?(e=Math.floor(b/60)-24*c*60-60*d,f=Math.floor(b)-24*c*60*60-60*d*60-60*e):(m.prop("disabled",!1),m.html("马上投资"),l.find(".time-item").remove(),l.find(".expected-interest").parents("dd").removeClass("hide")),9>=e&&(e="0"+e),9>=f&&(f="0"+f),a("#minute_show").html(e+"分"),a("#second_show").html(f+"秒"),b--)},1e3)}function g(a){p.data("amount",a);var b=q.find(":checkbox");b.is(":checked")?h():i()}function h(){var a=parseFloat(r.html()),b=parseFloat(p.data("amount")),c=Math.round(100*(a+b));p.html(c/100)}function i(){var a=parseFloat(p.data("amount"));p.html(a)}var j=a(".loan-detail-content"),k=a(".text-input-amount",j),l=a(".account-info",j),m=a(".btn-pay",l),n=a(".loan-nav li"),o=a(".loan-list",j),p=(a("#picListBox"),a(".expected-interest")),q=a(".experience-ticket",j),r=a(".experience-interest",j),s=a(".pagination",j),t=a(".errorTip");k.autoNumeric("init"),e.ready(function(){e.photos({photos:"#picListBox"})});var u=function(b){var e={index:b||1};s.loadPagination(e,function(b){if(b.status){var e=c.render(d,b);a(".loan-list-con table").html(e)}})};if(java_point<=50?(a(".chart-box .rount").css("webkitTransform","rotate("+3.6*java_point+"deg)"),a(".chart-box .rount2").hide()):(a(".chart-box .rount").css("webkitTransform","rotate(180deg)"),a(".chart-box .rount2").show(),a(".chart-box .rount2").css("webkitTransform","rotate("+3.6*(java_point-50)+"deg)")),o.find(".loan-list-con").eq(0).show(),n.click(function(){var b=a(this);b.addClass("active").siblings("li").removeClass("active");var c=b.index();1===c&&u(),o.find(".loan-list-con").eq(c).show().siblings(".loan-list-con").hide()}),"PREHEAT"==a("#loanStatus").val()&&f(intDiff),k.length){q.is(":hidden")?a(".account-list").find("dd").last().css({"margin-top":"20px"}):q.find(":checkbox").on("click",function(){var b,c=a(this);b=c.is(":checked"),b?(q.next("dd.experience-revenue").show(),h()):(q.next("dd.experience-revenue").hide(),i())});var v=function(b){var c=a(".hid-loan").val(),d=k.val();""==d&&(d="0.00");var f=a("form .amountNeedRaised-i").text();if(Number(f)<Number(d)||0>=d){var h;return h=0>=d?"输入金额不能等于0!":"输入金额不能大于可投金额!",e.tips('<i class="fa fa-times-circle"></i>'+h,".text-input-amount",{tips:[1,"#ff7200"],time:0}),void m.prop("disabled",!0)}e.closeAll("tips"),m.prop("disabled",!1),a.ajax({url:"/calculate-expected-interest/loan/"+c+"/amount/"+d,type:"get",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(a){b||e.closeAll("tips"),g(a),m.prop("disabled",!1)})};"undefined"!=typeof user_can_invest&&v(!0),k.blur(function(){v(!1)}),a("form").submit(function(){var b=a(this);if("/invest"===b.attr("action")){if("undefined"==typeof user_can_invest)return location.href="/login?redirect="+encodeURIComponent(location.href),!1;var c=a("input[name='amount']",b).val();if(isNaN(parseFloat(c)))return!1;var d=parseFloat(c),e=parseFloat(a("form .account-amount").text());return d>e?(location.href="/recharge",!1):!0}return!0})}t.length&&e.tips('<i class="fa fa-times-circle"></i>'+t.text(),".text-input-amount",{tips:[1,"#ff7200"],time:0})});