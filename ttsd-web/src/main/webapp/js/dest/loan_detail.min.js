require(["jquery","pagination","mustache","text!/tpl/loan-invest-list.mustache","layerWrapper","csrf","autoNumeric"],function(a,b,c,d,e){function f(b){window.setInterval(function(){var c=0,d=0,e=0,f=0;1800>=b&&(b>0?(e=Math.floor(b/60)-24*c*60-60*d,f=Math.floor(b)-24*c*60*60-60*d*60-60*e):(j.prop("disabled",!1),j.html("马上投资"),i.find(".time-item").remove(),i.find(".expected-interest").parents("dd").removeClass("hide")),9>=e&&(e="0"+e),9>=f&&(f="0"+f),a("#minute_show").html(e+"分"),a("#second_show").html(f+"秒"),b--)},1e3)}var g=a(".loan-detail-content"),h=a(".text-input-amount"),i=a(".account-info"),j=a(".btn-pay",i),k=a(".error",i),l=a(".loan-nav li"),m=a(".loan-list",g),n=(a("#picListBox"),a(".pagination"));h.autoNumeric("init"),e.ready(function(){e.photos({photos:"#picListBox"})});var o=function(b){var e={index:b||1};n.loadPagination(e,function(b){if(b.status){var e=c.render(d,b);a(".loan-list-con table").html(e)}})};if(java_point<=50?(a(".chart-box .rount").css("webkitTransform","rotate("+3.6*java_point+"deg)"),a(".chart-box .rount2").hide()):(a(".chart-box .rount").css("webkitTransform","rotate(180deg)"),a(".chart-box .rount2").show(),a(".chart-box .rount2").css("webkitTransform","rotate("+3.6*(java_point-50)+"deg)")),m.find(".loan-list-con").eq(0).show(),l.click(function(){var b=a(this);b.addClass("active").siblings("li").removeClass("active");var c=b.index();1===c&&o(),m.find(".loan-list-con").eq(c).show().siblings(".loan-list-con").hide()}),"PREHEAT"==a("#loanStatus").val()&&f(intDiff),h.length){var p=function(b){var c=a(".hid-loan").val(),d=parseFloat(h.autoNumeric("get"));isNaN(d)&&(d="0");var e=a("form .amountNeedRaised-i").text();return Number(e)<Number(d)?(k.html("<i class='fa fa-times-circle'></i>输入金额不能大于可投金额!").removeAttr("style"),void j.prop("disabled",!0)):void a.ajax({url:"/calculate-expected-interest/loan/"+c+"/amount/"+d,type:"get",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(c){b||k.hide(),a(".expected-interest").html(c),j.prop("disabled",!1)})};p(!0),h.blur(function(){p(!1)}),a("form").submit(function(){var b=a(this);if("/invest"===b.attr("action")){if("undefined"==typeof user_can_invest)return location.href="/login?redirect="+encodeURIComponent(location.href),!1;var c=a("input[name='amount']",b).val();if(isNaN(parseFloat(c)))return k.html("<i class='fa fa-times-circle'></i>请正确输入投资金额").removeAttr("style"),!1;var d=parseFloat(c),e=parseFloat(a("form .account-amount").text());return d>e?(location.href="/recharge",!1):!0}return!0})}});