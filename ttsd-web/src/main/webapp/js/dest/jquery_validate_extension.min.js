require(["jquery","commonFun","jquery.validate"],function(a,b){var c=function(b,c,d){var e=!1,f=d.validator,g=d.element,h=f.previousValue(g),i=d.errorMessage;a.ajax({url:b,type:"GET",dataType:"json",error:function(a){h.valid=e,f.stopRequest(g,e)},success:function(b){if(e=c(b)){var d=f.formSubmitted;f.prepareElement(g),f.formSubmitted=d,f.successList.push(g),delete f.invalid[g.name],f.showErrors()}else{var j={};j[g.name]=h.message=a.isFunction(i)?i(value):i,f.invalid[g.name]=!0,f.showErrors(j)}h.valid=e,f.stopRequest(g,e)}})},d=function(b,d,e){var f=this.previousValue(d),g=this;if(f.old===b)return f.valid;f.old=b,this.startRequest(d);var h=g.defaultMessage(d,"isExist"),i=function(a){return a.success&&!a.data.status},j=a.validator.format(e);return c(j(encodeURIComponent(b)),i,{validator:g,element:d,errorMessage:h}),"pending"},e=function(b,d,e){var f=this.previousValue(d),g=this;if(""===a('.register-user-form input[name="referrer"]').val())return g.showErrors(),"pending";if(f.old===b)return f.valid;f.old=b,this.startRequest(d);var h=g.defaultMessage(d,"isNotExist"),i=function(a){return a.success&&a.data.status},j=a.validator.format(e);return c(j(encodeURIComponent(b)),i,{validator:g,element:d,errorMessage:h}),"pending"},f=function(b,d,e){var f=this.previousValue(d),g=this;if(f.old===b)return f.valid;f.old=b,this.startRequest(d);var h=g.defaultMessage(d,"imageCaptchaVerify"),i=function(a){return a.success&&a.data.status},j=a.validator.format(e);return c(j(b),i,{validator:g,element:d,errorMessage:h}),"pending"},g=function(b,d,e){var f=this.previousValue(d),g=this,h=g.check('input[name="mobile"]');if(!h)return!1;if(f.old===b)return f.valid;f.old=b,this.startRequest(d);var i=g.defaultMessage(d,"captchaVerify"),j=function(a){return a.success&&a.data.status},k=a.validator.format(e);return c(k(b),j,{validator:g,element:d,errorMessage:i}),"pending"};a.validator.addMethod("regex",function(a,b,c){return this.optional(b)||c.test(a)},"请检查您的输入"),a.validator.addMethod("identityCheckValid",function(a,c){var d=b.IdentityCodeValid(a);return this.optional(c)||d},""),a.validator.addMethod("identityCardAge",function(a,c){var d=b.IdentityCodeValid(a),e=a.substring(6,14),f=new Date,g=!0;if(d){var h=f.getFullYear(),i=f.getMonth()+1,j=f.getDate(),k=h+""+(10>i?"0"+i:i)+(10>j?"0"+j:j),l=Math.floor((k-e)/1e4);18>l&&(g=!1)}return this.optional(c)||g},""),a.validator.addMethod("isExist",function(a,b,c){return d.call(this,a,b,c)},a.validator.format("该记录已存在")),a.validator.addMethod("isNotExist",function(a,b,c){return e.call(this,a,b,c)},a.validator.format("该记录已存在")),a.validator.addMethod("captchaVerify",function(a,b,c){return g.call(this,a,b,c)},a.validator.format("手机验证码不正确")),a.validator.addMethod("imageCaptchaVerify",function(a,b,c){return f.call(this,a,b,c)},a.validator.format("图形验证码不正确"))});