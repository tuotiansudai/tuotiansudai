require(["jquery","mustache","text!/tpl/refer-table.mustache","text!/tpl/refer-invest-table.mustache","moment","pagination","layerWrapper","clipboard","commonFun","daterangepicker","jquery.ajax.extension","md5","qrcode"],function(a,b,c,d,e,f,g,h,i){window.Clipboard=h;var j=a("#investListContent"),k=a("#clipboard_text"),l=a("#search-box"),m=a("#date-picker"),n=a("#loginName"),o=a("#referRelationPagination"),p=a("#referInvestPagination"),q=a(".btn-search",l),r=a(".btn-reset",l),s=a(".search-content-tab"),t=k.data("mobile")+"",u=a.md5(t);void 0==window.context&&(window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")));var v=i.compile(u,t),w=location.origin;k.val(w+"/activity/landing-page?referrer="+v),a(".img-code",j).qrcode(w+"/activity/app-share?referrerMobile="+t),function(a){var b=new Clipboard("#copyButtonBtn");b.on("success",function(a){g.msg("复制成功"),a.clearSelection()}),b.on("error",function(a){g.msg("复制失败")})}(jQuery);var x=o,y=c;e().format("YYYY-MM-DD");m.dateRangePicker({separator:" ~ "}),a(".search-type .select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),"referRelation"==a(this).data("type")?(o.show(),p.hide(),x=o,y=c):"referInvest"==a(this).data("type")&&(o.hide(),p.show(),x=p,y=d),z()});var z=function(c){var d=m.val().split("~"),e=a.trim(d[0])||"",f=a.trim(d[1])||"",h=a("#loginName").val(),i={startTime:e,endTime:f,loginName:h,index:c||1},j="";_.each(i,function(a,b){j+=b+"="+a+"&"}),x.loadPagination(i,function(c){a.ajax({url:"total-reward?"+j,type:"get",dataType:"json",contentType:"application/json; charset=UTF-8"}).success(function(a){c.totalReward=a;var d=b.render(y,c);s.empty().append(d)})}),a(".search-content-tab").on("mouseenter","span.loan-name-col",function(){g.closeAll("tips"),a(this).text().length>13&&g.tips(a(this).text(),a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})})};z(),q.click(function(){z()}),r.click(function(){m.val(""),n.val("")})});